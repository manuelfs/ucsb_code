#include "pu_constants.hpp"
#include "TObject.h"

const float pu::TrueDist2011_f[35] = {
  0,
  304761,
  5.78132e+06,
  5.06699e+07,
  2.69238e+08,
  5.18854e+08,
  5.76628e+08,
  5.33043e+08,
  4.66102e+08,
  4.26606e+08,
  3.82425e+08,
  3.51807e+08,
  3.30761e+08,
  2.94186e+08,
  2.29225e+08,
  1.45499e+08,
  7.43711e+07,
  3.08969e+07,
  1.0913e+07,
  3.68176e+06,
  1.13003e+06,
  288668,
  64020.4,
  2350.83,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
};

/*
  this data distribution is an hadd of the following histograms:  
  (all in /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions11/7TeV/PileUp/)

  Cert_160404-163869_7TeV_May10ReReco_Collisions11_JSON_v3.pileup_v2.root
  Cert_165088-167913_7TeV_PromptReco_JSON.pileup_v2.root
  Cert_170249-172619_7TeV_ReReco5Aug_Collisions11_JSON_v2.pileup_v2.root
  Cert_172620-173692_PromptReco_JSON.pileup_v2.root
  Cert_175832-177515_PromptReco_JSON.pileup_v2.root
  Cert_177718_178078_7TeV_PromptReco_Collisons11_JSON.pileup_v2.root
  Cert_178098-180252_7TeV_PromptReco_Collisions11_JSON.pileup_v2.root
*/

const float pu::ObsDist2011_f[35] = {
  1.34465e+07,
  5.90653e+07,
  1.40903e+08,
  2.41301e+08,
  3.33745e+08,
  3.98711e+08,
  4.30106e+08,
  4.32283e+08,
  4.1382e+08,
  3.82846e+08,
  3.45164e+08,
  3.04344e+08,
  2.62555e+08,
  2.21331e+08,
  1.81983e+08,
  1.4569e+08,
  1.13413e+08,
  8.57789e+07,
  6.30124e+07,
  4.49596e+07,
  3.1169e+07,
  2.10079e+07,
  1.37759e+07,
  8.79641e+06,
  5.47442e+06,
  3.32378e+06,
  1.97064e+06,
  1.14204e+06,
  647539,
  359547,
  195673,
  104460,
  54745.2,
  28185.6,
  28005.5
};


// Flat10+Tail distribution taken directly from MixingModule input:  
//(Can be used for Spring11 and Summer11 if you don't worry about small shifts in the mean) 
//SHOULD be used for 3-D Reweighting, as this is the "true" input for all Summer11 samples.

const Double_t pu::probdistFlat10_f[35] = {
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0698146584,
  0.0630151648,
  0.0526654164,
  0.0402754482,
  0.0292988928,
  0.0194384503,
  0.0122016783,
  0.007207042,
  0.004003637,
  0.0020278322,
  0.0010739954,
  0.0004595759,
  0.0002229748,
  0.0001028162,
  4.58337152809607E-05,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
};


// Summer11 PU_S4, distribution obtained by only looking at the in-time crossing.  This is the "spike+smear" distribution
// RECOMMENDED FOR REWEIGHTING (if ignoring out-of-time PU)
const float pu::PoissonOneXDist_f[35] = {
  1.45346E-01,
  6.42802E-02,
  6.95255E-02,
  6.96747E-02,
  6.92955E-02,
  6.84997E-02,
  6.69528E-02,
  6.45515E-02,
  6.09865E-02,
  5.63323E-02,
  5.07322E-02,
  4.44681E-02,
  3.79205E-02,
  3.15131E-02,
  2.54220E-02,
  2.00184E-02,
  1.53776E-02,
  1.15387E-02,
  8.47608E-03,
  6.08715E-03,
  4.28255E-03,
  2.97185E-03,
  2.01918E-03,
  1.34490E-03,
  8.81587E-04,
  5.69954E-04,
  3.61493E-04,
  2.28692E-04,
  1.40791E-04,
  8.44606E-05,
  5.10204E-05,
  3.07802E-05,
  1.81401E-05,
  1.00201E-05,
  5.80004E-06
};

// from https://twiki.cern.ch/twiki/bin/view/CMS/Pileup_MC_Gen_Scenarios
// allegedly correct for PU_S6 ?? https://twiki.cern.ch/twiki/bin/view/CMS/PdmVPileUpDescription#Profiles_in_Simulation
const Double_t pu::Fall2011[60] = {
  0.003388501,
  0.010357558,
  0.024724258,
  0.042348605,
  0.058279812,
  0.068851751,
  0.072914824,
  0.071579609,
  0.066811668,
  0.060672356,
  0.054528356,
  0.04919354,
  0.044886042,
  0.041341896,
  0.0384679,
  0.035871463,
  0.03341952,
  0.030915649,
  0.028395374,
  0.025798107,
  0.023237445,
  0.020602754,
  0.0180688,
  0.015559693,
  0.013211063,
  0.010964293,
  0.008920993,
  0.007080504,
  0.005499239,
  0.004187022,
  0.003096474,
  0.002237361,
  0.001566428,
  0.001074149,
  0.000721755,
  0.000470838,
  0.00030268,
  0.000184665,
  0.000112883,
  6.74043E-05,
  3.82178E-05,
  2.22847E-05,
  1.20933E-05,
  6.96173E-06,
  3.4689E-06,
  1.96172E-06,
  8.49283E-07,
  5.02393E-07,
  2.15311E-07,
  9.56938E-08,
  0,0,0,0,0,0,0,0,0,0
};

// Distribution used for Summer2012 MC.
//from https://twiki.cern.ch/twiki/bin/viewauth/CMS/PileupMCReweightingUtilities
const float pu::Summer2012[60] = {
  2.344E-05,
  2.344E-05,
  2.344E-05,
  2.344E-05,
  4.687E-04,
  4.687E-04,
  7.032E-04,
  9.414E-04,
  1.234E-03,
  1.603E-03,
  2.464E-03,
  3.250E-03,
  5.021E-03,
  6.644E-03,
  8.502E-03,
  1.121E-02,
  1.518E-02,
  2.033E-02,
  2.608E-02,
  3.171E-02,
  3.667E-02,
  4.060E-02,
  4.338E-02,
  4.520E-02,
  4.641E-02,
  4.735E-02,
  4.816E-02,
  4.881E-02,
  4.917E-02,
  4.909E-02,
  4.842E-02,
  4.707E-02,
  4.501E-02,
  4.228E-02,
  3.896E-02,
  3.521E-02,
  3.118E-02,
  2.702E-02,
  2.287E-02,
  1.885E-02,
  1.508E-02,
  1.166E-02,
  8.673E-03,
  6.190E-03,
  4.222E-03,
  2.746E-03,
  1.698E-03,
  9.971E-04,
  5.549E-04,
  2.924E-04,
  1.457E-04,
  6.864E-05,
  3.054E-05,
  1.282E-05,
  5.081E-06,
  1.898E-06,
  6.688E-07,
  2.221E-07,
  6.947E-08,
  2.047E-08
};  

//for S10 scenario, see here: https://twiki.cern.ch/twiki/bin/view/CMS/Pileup_MC_Gen_Scenarios
const float pu::Summer2012_S10[60] = {
  2.560E-06,
  5.239E-06,
  1.420E-05,
  5.005E-05,
  1.001E-04,
  2.705E-04,
  1.999E-03,
  6.097E-03,
  1.046E-02,
  1.383E-02,
  1.685E-02,
  2.055E-02,
  2.572E-02,
  3.262E-02,
  4.121E-02,
  4.977E-02,
  5.539E-02,
  5.725E-02,
  5.607E-02,
  5.312E-02,
  5.008E-02,
  4.763E-02,
  4.558E-02,
  4.363E-02,
  4.159E-02,
  3.933E-02,
  3.681E-02,
  3.406E-02,
  3.116E-02,
  2.818E-02,
  2.519E-02,
  2.226E-02,
  1.946E-02,
  1.682E-02,
  1.437E-02,
  1.215E-02,
  1.016E-02,
  8.400E-03,
  6.873E-03,
  5.564E-03,
  4.457E-03,
  3.533E-03,
  2.772E-03,
  2.154E-03,
  1.656E-03,
  1.261E-03,
  9.513E-04,
  7.107E-04,
  5.259E-04,
  3.856E-04,
  2.801E-04,
  2.017E-04,
  1.439E-04,
  1.017E-04,
  7.126E-05,
  4.948E-05,
  3.405E-05,
  2.322E-05,
  1.570E-05,
  5.005E-06
};


// $ pileupCalc.py -i /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/Prompt/Cert_190456-207469_8TeV_PromptReco_Collisions12_JSON.txt --inputLumiJSON  /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/PileUp/pileup_JSON_DCSONLY_190389-207372_corr.txt --calcMode true --minBiasXsec 73500 --maxPileupBin 60 --numPileupBins 60 MyDataPileupHistogramNov23.root
const float pu::RunsThrough207469[60] = {
  11267.9,
  17844.8,
  74493.6,
  220946,
  471899,
  1.11118e+06,
  8.78177e+06,
  3.11873e+07,
  7.47868e+07,
  1.59821e+08,
  2.89287e+08,
  4.68866e+08,
  6.62969e+08,
  7.97219e+08,
  8.6972e+08,
  9.19347e+08,
  9.59677e+08,
  9.85186e+08,
  9.93874e+08,
  9.8893e+08,
  9.71294e+08,
  9.44744e+08,
  9.14165e+08,
  8.81232e+08,
  8.43598e+08,
  7.95965e+08,
  7.33986e+08,
  6.57499e+08,
  5.70215e+08,
  4.77141e+08,
  3.8362e+08,
  2.95482e+08,
  2.18029e+08,
  1.54385e+08,
  1.05029e+08,
  6.85976e+07,
  4.29204e+07,
  2.56697e+07,
  1.46648e+07,
  8.01655e+06,
  4.21203e+06,
  2.14155e+06,
  1.06252e+06,
  519178,
  252149,
  122741,
  60278.5,
  29981.8,
  15112.6,
  7700.06,
  3946.04,
  2021.36,
  1028.46,
  516.805,
  255.299,
  123.543,
  58.4146,
  26.9386,
  12.1017,
  152942
};

//systematic variation
// $ pileupCalc.py -i /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/Prompt/Cert_190456-207469_8TeV_PromptReco_Collisions12_JSON.txt --inputLumiJSON /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/PileUp/pileup_JSON_DCSONLY_190389-207372_corr.txt --calcMode true --minBiasXsec 69400 --maxPileupBin 60 --numPileupBins 60 MyDataPileupHistogramNov23syst.root
const float pu::RunsThrough207469systVar[60] = {
  12098.2,
  19698.8,
  59247.9,
  247858,
  516901,
  2.45849e+06,
  1.64921e+07,
  4.95374e+07,
  1.17995e+08,
  2.40688e+08,
  4.17966e+08,
  6.40522e+08,
  8.14769e+08,
  9.08737e+08,
  9.66666e+08,
  1.01329e+09,
  1.04294e+09,
  1.05263e+09,
  1.04617e+09,
  1.02485e+09,
  9.93963e+08,
  9.59012e+08,
  9.20967e+08,
  8.75424e+08,
  8.15632e+08,
  7.38056e+08,
  6.45134e+08,
  5.42701e+08,
  4.37292e+08,
  3.36063e+08,
  2.46063e+08,
  1.71958e+08,
  1.14883e+08,
  7.33312e+07,
  4.461e+07,
  2.57971e+07,
  1.41717e+07,
  7.41436e+06,
  3.71586e+06,
  1.79932e+06,
  850568,
  396872,
  184733,
  86558.9,
  41080,
  19792.6,
  9663.65,
  4756.46,
  2343.28,
  1146.77,
  553.685,
  262.283,
  121.388,
  54.7257,
  23.9843,
  10.2045,
  4.21112,
  1.68453,
  0.652917,
  218330
};

//https://twiki.cern.ch/twiki/bin/view/CMS/PileupJSONFileforData
// command run for all pre technical stop data (ku):
// pileupCalc.py -i /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/Prompt/Cert_190456-203002_8TeV_PromptReco_Collisions12_JSON.txt --inputLumiJSON /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/PileUp/pileup_JSON_DCSONLY_190389-203002_corr.txt --calcMode true --minBiasXsec 73500 --maxPileupBin 60 --numPileupBins 60 MyDataPileupHistogram.root

const float pu::RunsThrough203002[60] = {
  11267.8,            
  17830.4,            
  31465.3,            
  203836,             
  453856,             
  884081,             
  7.4738e+06,       
  2.6826e+07,       
  6.40799e+07,      
  1.28058e+08,      
  2.25003e+08,      
  3.60398e+08,      
  5.02337e+08,      
  6.02038e+08,      
  6.55226e+08,      
  6.91904e+08,      
  7.21875e+08,      
  7.34934e+08,      
  7.27792e+08,      
  7.09462e+08,      
  6.84817e+08,      
  6.56681e+08,      
  6.27203e+08,      
  5.97767e+08,      
  5.67254e+08,      
  5.29928e+08,      
  4.80151e+08,      
  4.17443e+08,      
  3.46324e+08,      
  2.73094e+08,      
  2.03778e+08,      
  1.43532e+08,      
  9.56936e+07,      
  6.08551e+07,      
  3.72323e+07,      
  2.20123e+07,      
  1.25469e+07,      
  6.84526e+06,      
  3.54681e+06,      
  1.73821e+06,      
  807241,             
  358102,             
  153605,             
  64548.6,            
  26851,              
  11118.1,            
  4586.4,             
  1881.03,            
  764.753,            
  307.439,            
  122.04,             
  47.8314,            
  18.5277,            
  7.10434,            
  2.70077,            
  1.01883,            
  0.381335,           
  0.141453,           
  0.0519055,
  107717        };                    

// consider lower min bias cross section for systematic variation: https://twiki.cern.ch/twiki/bin/view/CMS/PileupJSONFileforData
// pileupCalc.py -i /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/Prompt/Cert_190456-203002_8TeV_PromptReco_Collisions12_JSON.txt --inputLumiJSON /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/PileUp/pileup_JSON_DCSONLY_190389-203002_corr.txt --calcMode true --minBiasXsec 69400 --maxPileupBin 60 --numPileupBins 60 MyDataPileupHistogram.root

const float pu::RunsThrough203002systVar[60] = {
  12228.3,
  30994.6,
  63118.3,
  218846,
  465120,
  2.35894e+06,
  1.40257e+07,
  4.0086e+07,
  8.7976e+07,
  1.70535e+08,
  2.99058e+08,
  4.57129e+08,
  5.78711e+08,
  6.40814e+08,
  6.77013e+08,
  7.06651e+08,
  7.18682e+08,
  7.11462e+08,
  6.94661e+08,
  6.70428e+08,
  6.4054e+08,
  6.08195e+08,
  5.75479e+08,
  5.39928e+08,
  4.94897e+08,
  4.36349e+08,
  3.66608e+08,
  2.91967e+08,
  2.19264e+08,
  1.54624e+08,
  1.02502e+08,
  6.43564e+07,
  3.86402e+07,
  2.23072e+07,
  1.23554e+07,
  6.51432e+06,
  3.24317e+06,
  1.51951e+06,
  672571,
  284213,
  116311,
  46723.5,
  18590.2,
  7349.8,
  2884.7,
  1120.94,
  430.102,
  162.688,
  60.6486,
  22.3057,
  8.10828,
  2.91853,
  1.04135,
  0.36828,
  0.128918,
  0.0445702,
  0.0151809,
  0.00508254,
  0.00166966,
  0.00053755
};
// Note that this systematic variation version of the pileup distribution was created later than the nominal version above.
// When I try recreating the nominal now, I get different results, which I commented out below. (10-30-12, ku)
/*
  const float pu::RunsThrough203002[60] = {
  11378.3,
  20860,          
  58983.3,        
  163794,         
  395688,         
  1.07408e+06, 
  7.6992e+06,  
  2.56369e+07, 
  5.81059e+07, 
  1.14899e+08, 
  2.05191e+08, 
  3.35737e+08, 
  4.72612e+08, 
  5.65712e+08, 
  6.12376e+08, 
  6.4353e+08,  
  6.68983e+08, 
  6.78695e+08, 
  6.72202e+08, 
  6.57613e+08, 
  6.36744e+08, 
  6.10721e+08, 
  5.82132e+08, 
  5.53042e+08, 
  5.22836e+08, 
  4.86777e+08, 
  4.40091e+08, 
  3.82355e+08, 
  3.17439e+08, 
  2.50805e+08, 
  1.87733e+08, 
  1.32795e+08, 
  8.89934e+07, 
  5.69122e+07, 
  3.50106e+07, 
  2.08009e+07, 
  1.19094e+07, 
  6.52708e+06, 
  3.40033e+06, 
  1.67799e+06, 
  786088,         
  352332,         
  152846,         
  64958,          
  27298.9,        
  11399.5,        
  4733.22,        
  1950.78,        
  796.138,        
  321.084,        
  127.83,         
  50.2403,        
  19.5125,        
  7.50079,        
  2.85828,        
  1.08072,        
  0.405431,       
  0.150751,       
  0.0554592,   
  0.0201443       
  };
*/


//very crude first attempt...just trying to get something
//at command line:
/*
  pileupCalc.py -i GoldenJSON.txt --inputLumiJSON /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/PileUp/pileup_JSON_DCSONLY_190389-202478_corr.txt --calcMode true --minBiasXsec 69400 --maxPileupBin 60 --numPileupBins 60 MyDataPileupHistogram.root

  note that the json files don't exactly correspond
  Then in ROOT:
  for (int i=1; i<=60; i++) cout<<pileup->GetBinContent(i)<<","<<endl;
  Then copy/paste here


*/

const float pu::RunsThrough202016[60] = {
  12098.1,
  19663.6,
  37685.1,
  175102,
  480748,
  2.01443e+06,
  1.40346e+07,
  4.24219e+07,
  9.41773e+07,
  1.71649e+08,
  2.84218e+08,
  4.23014e+08,
  5.33103e+08,
  5.96032e+08,
  6.39027e+08,
  6.75738e+08,
  6.90847e+08,
  6.78478e+08,
  6.50954e+08,
  6.18435e+08,
  5.85033e+08,
  5.53875e+08,
  5.26098e+08,
  4.96961e+08,
  4.57616e+08,
  4.03022e+08,
  3.35367e+08,
  2.6168e+08,
  1.90249e+08,
  1.28354e+08,
  8.05909e+07,
  4.76831e+07,
  2.70876e+07,
  1.50146e+07,
  8.1584e+06,
  4.31026e+06,
  2.1853e+06,
  1.05407e+06,
  483856,
  213103,
  91085,
  38152.9,
  15745.8,
  6410.79,
  2572.33,
  1015.55,
  393.982,
  150.136,
  56.241,
  20.7474,
  7.5553,
  2.72186,
  0.971295,
  0.343299,
  0.120017,
  0.0414123,
  0.0140697,
  0.00469646,
  0.00153769,
  157660  };

const float pu::RunsThrough199703[60] = {
  9676.51,
  21216.3,
  46434,
  148828,
  587973,
  1.06826e+06,
  6.71038e+06,
  2.01898e+07,
  4.3258e+07,
  7.96691e+07,
  1.33624e+08,
  2.11984e+08,
  2.98125e+08,
  3.76286e+08,
  4.42083e+08,
  4.94324e+08,
  5.11127e+08,
  4.75004e+08,
  4.11169e+08,
  3.54216e+08,
  3.13188e+08,
  2.82781e+08,
  2.57139e+08,
  2.33125e+08,
  2.09973e+08,
  1.8757e+08,
  1.6579e+08,
  1.44676e+08,
  1.24467e+08,
  1.05478e+08,
  8.79922e+07,
  7.22246e+07,
  5.83052e+07,
  4.62772e+07,
  3.61038e+07,
  2.76809e+07,
  2.08537e+07,
  1.54351e+07,
  1.12231e+07,
  8.01604e+06,
  5.62346e+06,
  3.87439e+06,
  2.62128e+06,
  1.74134e+06,
  1.1357e+06,
  727103,
  456908,
  281779,
  170523,
  101252,
  58982,
  33705.1,
  18892.5,
  10386.5,
  5600.23,
  2961.23,
  1535.49,
  780.744,
  389.264,
  65588.9  };

// /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions12/8TeV/PileUp/

///////////////////////////////////////////////////
//The below PU distributions were used for the Summer 2011 result
///////////////////////////////////////////////////

////the data histogram obtained from: 
//// /afs/cern.ch/cms/CAF/CMSCOMM/COMM_DQM/certification/Collisions11/7TeV/PileUp/Pileup_2011_EPS_8_jul.root
//const float pu::TrueDist2011_f[25] = {
//  1.45417e+07,
//  3.47743e+07,
//  7.89247e+07,
//  1.26467e+08,
//  1.59329e+08,
//  1.67603e+08,
//  1.52684e+08,
//  1.23794e+08,
//  9.09462e+07,
//  6.13973e+07,
//  3.8505e+07,
//  2.2628e+07,
//  1.25503e+07,
//  6.61051e+06,
//  3.32403e+06,
//  1.60286e+06,
//  743920,
//  333477,
//  144861,
//  61112.7,
//  25110.2,
//  10065.1,
//  3943.98,
//  1513.54,
//  896.161
//};
////Summer11 PU_S4 distribution
////obtained from https://twiki.cern.ch/twiki/bin/viewauth/CMS/PileupMCReweightingUtilities
//const Double_t pu::PoissonIntDist_f[25] = {
//  0.104109,
//  0.0703573,
//  0.0698445,
//  0.0698254,
//  0.0697054,
//  0.0697907,
//  0.0696751,
//  0.0694486,
//  0.0680332,
//  0.0651044,
//  0.0598036,
//  0.0527395,
//  0.0439513,
//  0.0352202,
//  0.0266714,
//  0.019411,
//  0.0133974,
//  0.00898536,
//  0.0057516,
//  0.00351493,
//  0.00212087,
//  0.00122891,
//  0.00070592,
//  0.000384744,
//  0.000219377
//};
